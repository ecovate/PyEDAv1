on:
  workflow_dispatch:
    inputs:
      environment:
        required: true
        default: 'infra-test'
        description: |
          üõë DO NOT CHANGE THE DROPDOWN ABOVE FOR THE WORKFLOW. KEEP IT ON "main" BRANCH.
          --------------------------------------
          ‚¨áÔ∏è Environment.
        type: choice
        options:
          - infra-test
          # - dev
          # - prod
      action:
        required: true
        default: 'start'
        description: |
          Start / Stop environment
        type: choice
        options:
          - start
          - stop

jobs:
  service-in-test:
    if: ${{github.event.inputs.environment}} == 'infra-test'
    runs-on: ubuntu-latest
    steps:
      - name: 'start-service'
        if: github.event.inputs.action == 'start'
        run: |
          echo "aws ecs start-task --task-definition massgov-pfml-${{ github.event.inputs.taskdefinition }} --cluster massgov-pfml-${{ github.event.inputs.cluster }}"
          echo "aws rds start-db-instance --db-instance-identifier massgov-pfml-${{ github.event.inputs.environment }}"
      - name: 'stop-service'
        if: github.event.inputs.action == 'stop'
        run: |
          echo "aws ecs stop-task --task-definition massgov-pfml-${{ github.event.inputs.taskdefinition }} --cluster massgov-pfml-${{ github.event.inputs.cluster }}"
          echo "aws rds stop-db-instance --db-instance-identifier massgov-pfml-${{ github.event.inputs.environment }}"

  service-in-prod:
    if: github.event.inputs.environment == 'prod'
    runs-on: ubuntu-latest
    steps:
      - name: 'start-service'
        if: github.event.inputs.action == 'start-service'
        run: |
          echo "aws ecs start-task --task-definition massgov-pfml-${{ github.event.inputs.taskdefinition }} --cluster massgov-pfml-${{ github.event.inputs.cluster }}"
          echo "aws rds start-db-instance --db-instance-identifier massgov-pfml-${{ github.event.inputs.environment }}"
      - name: 'stop-service'
        if: github.event.inputs.action == 'stop-service'
        run: |
          echo "aws ecs stop-task --task-definition massgov-pfml-${{ github.event.inputs.taskdefinition }} --cluster massgov-pfml-${{ github.event.inputs.cluster }}"
          echo "aws rds stop-db-instance --db-instance-identifier massgov-pfml-${{ github.event.inputs.environment }}"
